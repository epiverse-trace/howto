[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "…"
  },
  {
    "objectID": "about.html#what-will-you-learn",
    "href": "about.html#what-will-you-learn",
    "title": "About",
    "section": "",
    "text": "…"
  },
  {
    "objectID": "about.html#who-are-these-for",
    "href": "about.html#who-are-these-for",
    "title": "About",
    "section": "Who are these for?",
    "text": "Who are these for?\nIn the creation of these materials, we though in:\n\nJuan, a Data Analyst and R user in a National Health Agency with constant deployment to outbreak response.\nCelina, a Post-doc and fluent R user who needs to keep up-to-date with the latest package developments.\nDaniel, a Trainer that wants to remix content to create specific training materials for public health practitioners."
  },
  {
    "objectID": "about.html#design-principles",
    "href": "about.html#design-principles",
    "title": "About",
    "section": "Design Principles",
    "text": "Design Principles\n\nProvide a “How-to” guides as single point solutions to specific problems.\nAdd links to related Explanation documentation.\nShow the context (part of the pipeline), ingredients (packages) and steps.\nAdd brief interpretation templates.\nFunctions, as in package websites, should have code-link to their Reference documentation.\nProvide a “search by keyword” to find what a user needs.\nShow the R code needed to solve Outbreak Analytics tasks.\nShow how Epidemiology R packages are integrated in pipelines.\nHelp to identify which coding task can be replaced by new R packages.\nProvide various infectious disease scenarios by world regions and data sources.\nRefer to external learning resources.\nRefer to a glossary of terms.\nRefer to good coding practices."
  },
  {
    "objectID": "about.html#reproducibility",
    "href": "about.html#reproducibility",
    "title": "About",
    "section": "Reproducibility",
    "text": "Reproducibility\n\nNon-invasive package management with {renv}"
  },
  {
    "objectID": "about.html#related-projects",
    "href": "about.html#related-projects",
    "title": "About",
    "section": "Related projects",
    "text": "Related projects\n\nepirecipes"
  },
  {
    "objectID": "describe_cases/epiparameter_extract_epiparam.html",
    "href": "describe_cases/epiparameter_extract_epiparam.html",
    "title": "How to extract the serial interval distribution from a systematic review?",
    "section": "",
    "text": "Conditions: - Use the serial interval distribution parameters of Ebola Virus Disease estimated from the WHO Ebola Response Team in 2015 to quantify the time-varying reproduction number.\n# Load required packages\nlibrary(epiparameter)\nlibrary(tidyverse)\n\n# Load the library of parameters as an epiparam object\nepiparam_all &lt;- epiparam()\n\n# Filter by disease, epi_distribution, region, and year\nepiparam_ebola &lt;- epiparam_all %&gt;% \n  filter(str_detect(disease,\"Ebola\")) %&gt;% \n  filter(epi_distribution == \"serial_interval\") %&gt;% \n  filter(region == \"West Africa\") %&gt;% \n  filter(year == 2015)\n\nepiparam_ebola\n\nEpiparam object\nNumber of distributions in library: 1\nNumber of diseases: 1\nNumber of delay distributions: 1\nNumber of offspring distributions: 0\nNumber of studies in library: 1\n&lt;Head of library&gt;\n              disease epi_distribution prob_distribution\n1 Ebola Virus Disease  serial_interval             gamma\n&lt;0 more rows & 53 more cols not shown&gt;\n\n# Convert a row to an epidist class object\nepidist_ebola &lt;- as_epidist(epiparam_ebola)\n\nepidist_ebola\n\nDisease: Ebola Virus Disease\nPathogen: Ebola Virus\nEpi Distribution: serial interval\nStudy: WHO Ebola Response Team (2015) &lt;10.1056/NEJMc1414992&gt; PMID: 25539446\nDistribution: gamma\nParameters:\n  shape: 2.188\n  scale: 6.490\n\n# Plot the epidist object\nplot(epidist_ebola,day_range = 0:50)"
  },
  {
    "objectID": "describe_cases/epiparameter_extract_epiparam.html#related",
    "href": "describe_cases/epiparameter_extract_epiparam.html#related",
    "title": "How to extract the serial interval distribution from a systematic review?",
    "section": "Related",
    "text": "Related\n\nExplanation on epidemiological distributions"
  },
  {
    "objectID": "describe_cases/growth_rate_day_i2extras_groups.html",
    "href": "describe_cases/growth_rate_day_i2extras_groups.html",
    "title": "How to estimate the growth rate stratified by groups?",
    "section": "",
    "text": "Conditions:\nlibrary(tidyverse)\nlibrary(covidregionaldata)\nlibrary(i2extras)\nlibrary(incidence2)\n\nraw_dat &lt;- \n  covidregionaldataUK %&gt;% \n  as_tibble() %&gt;% \n  filter(magrittr::is_in(region,c(\"England\", \"Scotland\", \n                                  \"Northern Ireland\", \"Wales\"))) %&gt;% \n  filter(date &gt; lubridate::ymd(20200701)) %&gt;%\n  filter(date &lt; lubridate::ymd(20201101))\n\nraw_dat %&gt;%\n  ggplot() +\n  aes(x = date, y = cases_new, col = region) +\n  geom_line()\n\n\n\n# Convert the data to an incidence object stratified by groups\ndat_group &lt;- \n  incidence2::incidence(\n    x = raw_dat, \n    counts = \"cases_new\",\n    date_index = \"date\",\n    interval = \"day\",\n    groups = \"region\"\n  )\n\ndat_group\n\n# incidence:  488 x 4\n# count vars: cases_new\n# groups:     region\n   date_index region           count_variable count\n * &lt;date&gt;     &lt;chr&gt;            &lt;fct&gt;          &lt;dbl&gt;\n 1 2020-07-02 England          cases_new        565\n 2 2020-07-02 Northern Ireland cases_new          3\n 3 2020-07-02 Scotland         cases_new         13\n 4 2020-07-02 Wales            cases_new         28\n 5 2020-07-03 England          cases_new        543\n 6 2020-07-03 Northern Ireland cases_new          8\n 7 2020-07-03 Scotland         cases_new          6\n 8 2020-07-03 Wales            cases_new         19\n 9 2020-07-04 England          cases_new        386\n10 2020-07-04 Northern Ireland cases_new          1\n# ℹ 478 more rows\n\n# Model the incidence\nout_group &lt;- \n  i2extras::fit_curve(\n    dat_group, \n    model = \"poisson\", \n    alpha = 0.05\n  )\n\n# Print the result\ni2extras::growth_rate(out_group)\n\n# A tibble: 4 × 10\n  count_variable region       model      r r_lower r_upper growth_or_decay  time\n  &lt;fct&gt;          &lt;chr&gt;        &lt;lis&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;\n1 cases_new      England      &lt;glm&gt; 0.0385  0.0384  0.0386 doubling         18.0\n2 cases_new      Northern Ir… &lt;glm&gt; 0.0438  0.0433  0.0443 doubling         15.8\n3 cases_new      Scotland     &lt;glm&gt; 0.0406  0.0402  0.0410 doubling         17.1\n4 cases_new      Wales        &lt;glm&gt; 0.0447  0.0443  0.0452 doubling         15.5\n# ℹ 2 more variables: time_lower &lt;dbl&gt;, time_upper &lt;dbl&gt;\n\n# Plot the result with prediction intervals\nplot(out_group, pi = TRUE)"
  },
  {
    "objectID": "describe_cases/growth_rate_day_i2extras_groups.html#related",
    "href": "describe_cases/growth_rate_day_i2extras_groups.html#related",
    "title": "How to estimate the growth rate stratified by groups?",
    "section": "Related",
    "text": "Related\n\nExplanation on incidence, growth rate, doubling time, and Poisson model"
  },
  {
    "objectID": "describe_cases/growth_rate_week_i2extras.html",
    "href": "describe_cases/growth_rate_week_i2extras.html",
    "title": "How to estimate the growth rate?",
    "section": "",
    "text": "Conditions: - Calculate the weekly growth rate. - Use the date of onset of symptoms. - Keep the first 20 weeks as period of analysis.\n# Calculate the weekly growth rate of an outbreak\n\n# Load required packages\nlibrary(outbreaks)\nlibrary(i2extras)\nlibrary(dplyr)\n\n# Load the simulated Ebola outbreak data\ndata(ebola_sim_clean)\n\n# Extract the first element of the list\nlinelist &lt;- ebola_sim_clean$linelist\n\n# Convert the data to an incidence2 object\nincidence2_data &lt;- \n  incidence2::incidence(\n    x = linelist, \n    date_index = \"date_of_onset\",\n    interval = \"week\"\n  )\n\n# Filter the dataset to keep the first 20 weeks. \nincidence2_filter &lt;- incidence2_data[1:20,]\n\n# Model the incidence\nincidence2_fit &lt;- \n  i2extras::fit_curve(\n    incidence2_filter, \n    model = \"poisson\", \n    alpha = 0.05\n  )\n\n# Print the result\ni2extras::growth_rate(incidence2_fit)\n\n# A tibble: 1 × 9\n  count_variable model      r r_lower r_upper growth_or_decay  time time_lower\n  &lt;chr&gt;          &lt;list&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;\n1 date_of_onset  &lt;glm&gt;  0.184   0.168   0.200 doubling         3.77       3.46\n# ℹ 1 more variable: time_upper &lt;dbl&gt;\n\n# Plot the result with prediction intervals\nplot(incidence2_fit, pi = TRUE)\n\n\n\n# Read plot documentation for an incidence2_fit object\n# ?plot.incidence2_fit\nPlease note that the code assumes the necessary packages are already installed. If they are not, you can install them using first the install.packages(\"pak\") function and then the pak::pak() function for both packages in CRAN or GitHub before loading them with library().\nAdditionally, make sure to adjust the serial interval distribution parameters according to the specific outbreak you are analyzing."
  },
  {
    "objectID": "describe_cases/growth_rate_week_i2extras.html#related",
    "href": "describe_cases/growth_rate_week_i2extras.html#related",
    "title": "How to estimate the growth rate?",
    "section": "Related",
    "text": "Related\n\nExplanation on incidence, growth rate, doubling time, and Poisson model"
  },
  {
    "objectID": "forecast_cases/projections_incidence_epitrix.html",
    "href": "forecast_cases/projections_incidence_epitrix.html",
    "title": "How to project the future trajectory of the outbreak?",
    "section": "",
    "text": "# Forecast the future trajectory of the outbreak\n\n# Load required packages\nlibrary(outbreaks)\nlibrary(i2extras)\nlibrary(epiparameter)\nlibrary(projections)\nlibrary(tidyverse)\n\n# Load the simulated Ebola outbreak data\ndata(ebola_sim_clean)\n\n# Extract the first element of the list\nlinelist &lt;- ebola_sim_clean$linelist\n\n# Convert the data to an incidence2 object\nincidence2_data &lt;- \n  incidence2::incidence(\n    x = linelist, \n    date_index = \"date_of_onset\",\n    interval = \"day\"\n  )\n\n# Filter the incidence2 object to keep the first 48 weeks. \nincidence2_filter &lt;- incidence2_data[1:48,]\n\n# Convert the filtered incidence2 object to an incidence object\nincidence1_filter &lt;- \n  incidence2_filter %&gt;% \n  tidyr::uncount(count) %&gt;% \n  dplyr::pull(date_index) %&gt;% \n  incidence::incidence()\n\n# Model the incidence\nincidence2_fit &lt;- \n  i2extras::fit_curve(\n    x = incidence2_filter,\n    model = \"poisson\",\n    alpha = 0.05\n  )\n\n# Extract parameter by disease, distribution, author\nepidist_ebola_si &lt;- \n  epidist_db(\n    disease = \"Ebola\",\n    epi_dist = \"serial_interval\",\n    author = \"WHO_Ebola_Response_Team\"\n  )\n\ndiscrete_ebola_si &lt;- discretise(epidist_ebola_si)\n\nreproductive_basic &lt;- \n  epitrix::lm2R0_sample(\n    x = incidence2_fit %&gt;% pull(model) %&gt;% pluck(1),\n    w = discrete_ebola_si$prob_dist,\n    n = 500\n  )\n\nsample_function &lt;- \n  function(x = reproductive_basic, n_sim = 1000){\n    mu &lt;- mean(x)\n    sigma &lt;- sd(x)\n    shape_scale &lt;- epitrix::gamma_mucv2shapescale(\n      mu = mu, \n      cv = sigma / mu\n    )\n    sample_result &lt;- rgamma(\n      n = n_sim, \n      shape = shape_scale$shape, \n      scale = shape_scale$scale\n    )\n    return(sample_result)\n  }\n\nreproductive_basic_sample &lt;- \n  sample_function(\n    x = reproductive_basic,\n    n_sim = 1000\n  )\n\nhist(reproductive_basic_sample)\n\n\n\ndistcrete_ebola_si &lt;- \n  distcrete::distcrete(\n    name = \"gamma\",\n    shape = discrete_ebola_si$prob_dist$parameters$shape,\n    scale = discrete_ebola_si$prob_dist$parameters$scale,\n    interval = discrete_ebola_si$prob_dist$interval,\n    w = discrete_ebola_si$prob_dist$w\n  )\n\nincidence1_projection &lt;- \n  project(\n    x = incidence1_filter, \n    R = reproductive_basic_sample,\n    si = distcrete_ebola_si, \n    n_sim = 1000, \n    n_days = 14, \n    R_fix_within = TRUE\n  )\n\nincidence1_filter %&gt;% \n  plot() %&gt;% \n  add_projections(\n    x = incidence1_projection,\n    quantiles = c(0.025, 0.5, 0.975)\n  )\n\n\n\n\nRelated:\n\nExplanation on projections"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Get started",
    "section": "",
    "text": "The goal of howto is to collect reproducible How to guides of Outbreak data analysis tasks using R packages."
  },
  {
    "objectID": "index.html#describe-case-data",
    "href": "index.html#describe-case-data",
    "title": "Get started",
    "section": "Describe case data",
    "text": "Describe case data\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\nTitle\n\n\n\n\n\n\nHow to estimate the growth rate stratified by groups?\n\n\n\n\nHow to estimate the growth rate?\n\n\n\n\nHow to extract the serial interval distribution from a systematic review?\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#quantify-transmission",
    "href": "index.html#quantify-transmission",
    "title": "Get started",
    "section": "Quantify transmission",
    "text": "Quantify transmission\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\nTitle\n\n\n\n\n\n\nHow to quantify the time-varying reproduction number (Rt) of the outbreak?\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#create-short-term-forecast",
    "href": "index.html#create-short-term-forecast",
    "title": "Get started",
    "section": "Create short-term forecast",
    "text": "Create short-term forecast\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\nTitle\n\n\n\n\n\n\nHow to project the future trajectory of the outbreak?\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#simulate-transmission-scenarios",
    "href": "index.html#simulate-transmission-scenarios",
    "title": "Get started",
    "section": "Simulate transmission scenarios",
    "text": "Simulate transmission scenarios\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\nTitle\n\n\n\n\n\n\nHow to create heterogeneous susceptibility matrices?\n\n\n\n\nHow to simulate the effective reproductive number accounting for heterogeneous social contact and homogeneous susceptibility in all age groups?\n\n\n\n\nHow to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between age groups?\n\n\n\n\nHow to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between and within age groups given immunization?\n\n\n\n\nHow to simulate the final size of an epidemic accounting for heterogeneous social contact and homogeneous susceptibility in all age groups?\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#more",
    "href": "index.html#more",
    "title": "Get started",
    "section": "More",
    "text": "More\nRefer to the About page for more details about the rationale behind the design of this site."
  },
  {
    "objectID": "quantify_transmission/reproduction_number_basic_epiestim_parametric.html",
    "href": "quantify_transmission/reproduction_number_basic_epiestim_parametric.html",
    "title": "How to quantify the time-varying reproduction number (Rt) of the outbreak?",
    "section": "",
    "text": "Conditions: - Use the first list element from the Simulated Ebola outbreak ebola_sim_clean object from the outbreaks R package. The name of the first element is linelist. - Use the “date of onset” column to calculate the weekly growth rate. - Use the serial interval distribution parameters of Ebola Virus Disease estimated from the WHO Ebola Response Team in 2015 to quantify the time-varying reproduction number. - Assume a known mean and standard deviation values of the serial interval distribution to quantify the time-varying reproduction number."
  },
  {
    "objectID": "quantify_transmission/reproduction_number_basic_epiestim_parametric.html#related",
    "href": "quantify_transmission/reproduction_number_basic_epiestim_parametric.html#related",
    "title": "How to quantify the time-varying reproduction number (Rt) of the outbreak?",
    "section": "Related",
    "text": "Related\n\nExplanation on effective reproductive number"
  },
  {
    "objectID": "simulate_cases/finalsize_effective_reproduction_number.html",
    "href": "simulate_cases/finalsize_effective_reproduction_number.html",
    "title": "How to simulate the effective reproductive number accounting for heterogeneous social contact and homogeneous susceptibility in all age groups?",
    "section": "",
    "text": "library(finalsize)\n\nWarning: package 'finalsize' was built under R version 4.2.3\n\nlibrary(socialmixr)\n\n\nAttaching package: 'socialmixr'\n\n\nThe following object is masked from 'package:utils':\n\n    cite\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.2.3\n\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'tidyr' was built under R version 4.2.3\n\n\nWarning: package 'readr' was built under R version 4.2.3\n\n\nWarning: package 'purrr' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\nWarning: package 'forcats' was built under R version 4.2.3\n\n\nWarning: package 'lubridate' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# get UK polymod data\npolymod &lt;- socialmixr::polymod\ncontact_data &lt;- socialmixr::contact_matrix(\n  polymod,\n  countries = \"United Kingdom\",\n  age.limits = c(0, 5, 18, 40, 65),\n  symmetric = TRUE\n)\n\nUsing POLYMOD social contact data. To cite this in a publication, use the 'cite' function\nRemoving participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option\n\n\nWarning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band).\n  Linearly estimating age group sizes from the 5-year bands.\n\n# get the contact matrix and demography data\ncontact_matrix &lt;- t(contact_data$matrix)\n\n# scale the contact matrix so the largest eigenvalue is 1.0\n# this is to ensure that the overall epidemic dynamics correctly reflect\n# the assumed value of R0\ncontact_matrix_scaled &lt;- contact_matrix / max(Re(eigen(contact_matrix)$values))\n\n# Define population in each age group\ndemography_vector &lt;- contact_data$demography$population\ndemography_groups &lt;- contact_data$demography$age.group\n\ndemography_vector\n\n[1]  3453670  9761554 18110368 19288101  9673058\n\ndemography_groups\n\n[1] \"[0,5)\"   \"[5,18)\"  \"[18,40)\" \"[40,65)\" \"65+\"    \n\n# divide each row of the contact matrix by the corresponding demography\n# this reflects the assumption that each individual in group {j} make contacts\n# at random with individuals in group {i}\ncontact_matrix_random &lt;- contact_matrix_scaled / demography_vector\n\n# Define susceptibility of each group\n# susceptibility matrix\nsusceptibility &lt;- tibble(\n  age_group = demography_groups,\n  susceptible = c(0.8, 0.8, 0.8, 0.8, 0.8)\n) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\nsusceptibility\n\n        susceptible\n[0,5)           0.8\n[5,18)          0.8\n[18,40)         0.8\n[40,65)         0.8\n65+             0.8\n\n# Assume uniform susceptibility within age groups\n# demography-in-susceptibility matrix\np_susceptibility &lt;- tibble(\n  age_group = demography_groups,\n  susceptible = c(1.0, 1.0, 1.0, 1.0, 1.0)\n) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\np_susceptibility\n\n        susceptible\n[0,5)             1\n[5,18)            1\n[18,40)           1\n[40,65)           1\n65+               1\n\n# R0 of the disease\nr0 &lt;- 1.5 # assumed for pandemic influenza\n\n# calculate the effective R0 using `r_eff()`\nr_eff(\n  r0 = r0,\n  contact_matrix = contact_matrix_random,\n  demography_vector = demography_vector,\n  susceptibility = susceptibility,\n  p_susceptibility = p_susceptibility\n)\n\n[1] 1.2"
  },
  {
    "objectID": "simulate_cases/finalsize_effective_reproduction_number.html#related",
    "href": "simulate_cases/finalsize_effective_reproduction_number.html#related",
    "title": "How to simulate the effective reproductive number accounting for heterogeneous social contact and homogeneous susceptibility in all age groups?",
    "section": "Related",
    "text": "Related\n\nExplanation on effective reproductive number"
  },
  {
    "objectID": "simulate_cases/finalsize_heterogenious_between.html",
    "href": "simulate_cases/finalsize_heterogenious_between.html",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between age groups?",
    "section": "",
    "text": "This scenario assumes that, in the population, there is different susceptibility to the infection between individuals of different age groups, from 20% (infants) to 100% (65+).\nlibrary(finalsize)\n\nWarning: package 'finalsize' was built under R version 4.2.3\n\nlibrary(socialmixr)\n\n\nAttaching package: 'socialmixr'\n\n\nThe following object is masked from 'package:utils':\n\n    cite\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.2.3\n\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'tidyr' was built under R version 4.2.3\n\n\nWarning: package 'readr' was built under R version 4.2.3\n\n\nWarning: package 'purrr' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\nWarning: package 'forcats' was built under R version 4.2.3\n\n\nWarning: package 'lubridate' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# get UK polymod data\npolymod &lt;- socialmixr::polymod\ncontact_data &lt;- socialmixr::contact_matrix(\n  polymod,\n  countries = \"United Kingdom\",\n  age.limits = c(0, 5, 18, 40, 65),\n  symmetric = TRUE\n)\n\nUsing POLYMOD social contact data. To cite this in a publication, use the 'cite' function\nRemoving participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option\n\n\nWarning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band).\n  Linearly estimating age group sizes from the 5-year bands.\n\n# get the contact matrix and demography data\ncontact_matrix &lt;- t(contact_data$matrix)\n\n# scale the contact matrix so the largest eigenvalue is 1.0\n# this is to ensure that the overall epidemic dynamics correctly reflect\n# the assumed value of R0\ncontact_matrix_scaled &lt;- contact_matrix / max(Re(eigen(contact_matrix)$values))\n\n# Define population in each age group\ndemography_vector &lt;- contact_data$demography$population\ndemography_groups &lt;- contact_data$demography$age.group\n\ndemography_vector\n\n[1]  3453670  9761554 18110368 19288101  9673058\n\ndemography_groups\n\n[1] \"[0,5)\"   \"[5,18)\"  \"[18,40)\" \"[40,65)\" \"65+\"    \n\n# divide each row of the contact matrix by the corresponding demography\n# this reflects the assumption that each individual in group {j} make contacts\n# at random with individuals in group {i}\ncontact_matrix_random &lt;- contact_matrix_scaled / demography_vector\n\n# Define susceptibility of each group\n# susceptibility matrix\nsusceptibility &lt;- tibble(\n  age_group = demography_groups,\n  susceptible = c(0.2, 0.5, 0.6, 0.9, 1.0)\n) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\nsusceptibility\n\n        susceptible\n[0,5)           0.2\n[5,18)          0.5\n[18,40)         0.6\n[40,65)         0.9\n65+             1.0\n\n# Assume uniform susceptibility within age groups\n# demography-in-susceptibility matrix\np_susceptibility &lt;- tibble(\n  age_group = demography_groups,\n  susceptible = c(1.0, 1.0, 1.0, 1.0, 1.0)\n) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\np_susceptibility\n\n        susceptible\n[0,5)             1\n[5,18)            1\n[18,40)           1\n[40,65)           1\n65+               1\n\n# R0 of the disease\nr0 &lt;- 1.5 # assumed for pandemic influenza\n\n# Calculate the proportion of individuals infected in each age group\nfinal_size(\n  r0 = r0,\n  contact_matrix = contact_matrix_random,\n  demography_vector = demography_vector,\n  susceptibility = susceptibility,\n  p_susceptibility = p_susceptibility\n)\n\n  demo_grp    susc_grp susceptibility   p_infected\n1    [0,5) susceptible            0.2 6.974385e-07\n2   [5,18) susceptible            0.5 3.938000e-06\n3  [18,40) susceptible            0.6 3.518633e-06\n4  [40,65) susceptible            0.9 4.631178e-06\n5      65+ susceptible            1.0 3.148262e-06"
  },
  {
    "objectID": "simulate_cases/finalsize_heterogenious_between.html#related",
    "href": "simulate_cases/finalsize_heterogenious_between.html#related",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between age groups?",
    "section": "Related",
    "text": "Related\n\nExplanation on heterogeneous susceptibility"
  },
  {
    "objectID": "simulate_cases/finalsize_heterogenious_between_within.html",
    "href": "simulate_cases/finalsize_heterogenious_between_within.html",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between and within age groups given immunization?",
    "section": "",
    "text": "This scenario assumes that, in the population, there is different susceptibility to the infection: - between individuals of different age groups from 20% (infants) to 100% (65+), and - within individuals of the same age group due the immunization effect of 25%.\nThe immunization uptake rate is also different for each of the age groups: immunization increases with age from 20% (infants) to 90% (65+)\nlibrary(finalsize)\n\nWarning: package 'finalsize' was built under R version 4.2.3\n\nlibrary(socialmixr)\n\n\nAttaching package: 'socialmixr'\n\n\nThe following object is masked from 'package:utils':\n\n    cite\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.2.3\n\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'tidyr' was built under R version 4.2.3\n\n\nWarning: package 'readr' was built under R version 4.2.3\n\n\nWarning: package 'purrr' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\nWarning: package 'forcats' was built under R version 4.2.3\n\n\nWarning: package 'lubridate' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# get UK polymod data\npolymod &lt;- socialmixr::polymod\ncontact_data &lt;- socialmixr::contact_matrix(\n  polymod,\n  countries = \"United Kingdom\",\n  age.limits = c(0, 5, 18, 40, 65),\n  symmetric = TRUE\n)\n\nUsing POLYMOD social contact data. To cite this in a publication, use the 'cite' function\nRemoving participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option\n\n\nWarning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band).\n  Linearly estimating age group sizes from the 5-year bands.\n\n# get the contact matrix and demography data\ncontact_matrix &lt;- t(contact_data$matrix)\n\n# scale the contact matrix so the largest eigenvalue is 1.0\n# this is to ensure that the overall epidemic dynamics correctly reflect\n# the assumed value of R0\ncontact_matrix_scaled &lt;- contact_matrix / max(Re(eigen(contact_matrix)$values))\n\n# Define population in each age group\ndemography_vector &lt;- contact_data$demography$population\ndemography_groups &lt;- contact_data$demography$age.group\n\ndemography_vector\n\n[1]  3453670  9761554 18110368 19288101  9673058\n\ndemography_groups\n\n[1] \"[0,5)\"   \"[5,18)\"  \"[18,40)\" \"[40,65)\" \"65+\"    \n\n# divide each row of the contact matrix by the corresponding demography\n# this reflects the assumption that each individual in group {j} make contacts\n# at random with individuals in group {i}\ncontact_matrix_random &lt;- contact_matrix_scaled / demography_vector\n\n\n# Set and immunization effect\nimmunization_effect &lt;- 0.25\n\n# susceptibility matrix\nsusceptibility &lt;- tibble(\n  age_group = demography_groups,\n  unimmunised = c(0.2, 0.5, 0.6, 0.9, 1.0)\n) %&gt;%\n  mutate(immunised = unimmunised * (1 - immunization_effect)) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\nsusceptibility\n\n        unimmunised immunised\n[0,5)           0.2     0.150\n[5,18)          0.5     0.375\n[18,40)         0.6     0.450\n[40,65)         0.9     0.675\n65+             1.0     0.750\n\n# demography-in-susceptibility matrix\np_susceptibility &lt;- tibble(\n  age_group = demography_groups,\n  immunised = c(0.2, 0.4, 0.6, 0.7, 0.9)\n) %&gt;%\n  mutate(unimmunised = 1 - immunised) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\np_susceptibility\n\n        immunised unimmunised\n[0,5)         0.2         0.8\n[5,18)        0.4         0.6\n[18,40)       0.6         0.4\n[40,65)       0.7         0.3\n65+           0.9         0.1\n\n# R0 of the disease\nr0 &lt;- 1.5 # assumed for pandemic influenza\n\n# Calculate the proportion of individuals infected in each age group\nfinal_size(\n  r0 = r0,\n  contact_matrix = contact_matrix_random,\n  demography_vector = demography_vector,\n  susceptibility = susceptibility,\n  p_susceptibility = p_susceptibility\n)\n\n   demo_grp    susc_grp susceptibility   p_infected\n1     [0,5) unimmunised          0.200 4.499231e-08\n2    [5,18) unimmunised          0.500 2.406152e-07\n3   [18,40) unimmunised          0.600 2.247908e-07\n4   [40,65) unimmunised          0.900 2.849580e-07\n5       65+ unimmunised          1.000 1.847858e-07\n6     [0,5)   immunised          0.150 3.374423e-08\n7    [5,18)   immunised          0.375 1.804614e-07\n8   [18,40)   immunised          0.450 1.685931e-07\n9   [40,65)   immunised          0.675 2.137185e-07\n10      65+   immunised          0.750 1.385893e-07"
  },
  {
    "objectID": "simulate_cases/finalsize_heterogenious_between_within.html#related",
    "href": "simulate_cases/finalsize_heterogenious_between_within.html#related",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between and within age groups given immunization?",
    "section": "Related",
    "text": "Related"
  },
  {
    "objectID": "simulate_cases/finalsize_heterogenious_between_within.html#related-1",
    "href": "simulate_cases/finalsize_heterogenious_between_within.html#related-1",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and heterogeneous susceptibility between and within age groups given immunization?",
    "section": "Related",
    "text": "Related\n\nExplanation on heterogeneous susceptibility"
  },
  {
    "objectID": "simulate_cases/finalsize_homogenious.html",
    "href": "simulate_cases/finalsize_homogenious.html",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and homogeneous susceptibility in all age groups?",
    "section": "",
    "text": "library(finalsize)\n\nWarning: package 'finalsize' was built under R version 4.2.3\n\nlibrary(socialmixr)\n\n\nAttaching package: 'socialmixr'\n\n\nThe following object is masked from 'package:utils':\n\n    cite\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.2.3\n\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'tidyr' was built under R version 4.2.3\n\n\nWarning: package 'readr' was built under R version 4.2.3\n\n\nWarning: package 'purrr' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\nWarning: package 'forcats' was built under R version 4.2.3\n\n\nWarning: package 'lubridate' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# get UK polymod data\npolymod &lt;- socialmixr::polymod\ncontact_data &lt;- socialmixr::contact_matrix(\n  polymod,\n  countries = \"United Kingdom\",\n  age.limits = c(0, 5, 18, 40, 65),\n  symmetric = TRUE\n)\n\nUsing POLYMOD social contact data. To cite this in a publication, use the 'cite' function\nRemoving participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option\n\n\nWarning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band).\n  Linearly estimating age group sizes from the 5-year bands.\n\n# get the contact matrix and demography data\ncontact_matrix &lt;- t(contact_data$matrix)\n\n# scale the contact matrix so the largest eigenvalue is 1.0\n# this is to ensure that the overall epidemic dynamics correctly reflect\n# the assumed value of R0\ncontact_matrix_scaled &lt;- contact_matrix / max(Re(eigen(contact_matrix)$values))\n\n# Define population in each age group\ndemography_vector &lt;- contact_data$demography$population\ndemography_groups &lt;- contact_data$demography$age.group\n\n# divide each row of the contact matrix by the corresponding demography\n# this reflects the assumption that each individual in group {j} make contacts\n# at random with individuals in group {i}\ncontact_matrix_random &lt;- contact_matrix_scaled / demography_vector\n\n# Define susceptibility of each group\n# susceptibility matrix\nsusceptibility &lt;- tibble(\n  age_group = demography_groups,\n  susceptible = c(0.8, 0.8, 0.8, 0.8, 0.8)\n) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\nsusceptibility\n\n        susceptible\n[0,5)           0.8\n[5,18)          0.8\n[18,40)         0.8\n[40,65)         0.8\n65+             0.8\n\n# Assume uniform susceptibility within age groups\n# demography-in-susceptibility matrix\np_susceptibility &lt;- tibble(\n  age_group = demography_groups,\n  susceptible = c(1.0, 1.0, 1.0, 1.0, 1.0)\n) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\np_susceptibility\n\n        susceptible\n[0,5)             1\n[5,18)            1\n[18,40)           1\n[40,65)           1\n65+               1\n\n# R0 of the disease\nr0 &lt;- 1.5 # assumed for pandemic influenza\n\n# Calculate the proportion of individuals infected in each age group\nfinal_size(\n  r0 = r0,\n  contact_matrix = contact_matrix_random,\n  demography_vector = demography_vector,\n  susceptibility = susceptibility,\n  p_susceptibility = p_susceptibility\n)\n\n  demo_grp    susc_grp susceptibility p_infected\n1    [0,5) susceptible            0.8  0.1955285\n2   [5,18) susceptible            0.8  0.3985281\n3  [18,40) susceptible            0.8  0.2675113\n4  [40,65) susceptible            0.8  0.2198186\n5      65+ susceptible            0.8  0.1322135"
  },
  {
    "objectID": "simulate_cases/finalsize_homogenious.html#related",
    "href": "simulate_cases/finalsize_homogenious.html#related",
    "title": "How to simulate the final size of an epidemic accounting for heterogeneous social contact and homogeneous susceptibility in all age groups?",
    "section": "Related",
    "text": "Related\n\nExplanation on social contacts\nExplanation on heterogeneous susceptibility"
  },
  {
    "objectID": "simulate_cases/finalsize_susceptibility_matrices.html",
    "href": "simulate_cases/finalsize_susceptibility_matrices.html",
    "title": "How to create heterogeneous susceptibility matrices?",
    "section": "",
    "text": "Conditions:\n# Load required packages\nlibrary(tidyverse)\n\n# Define the immunization effect\nimmunization_effect &lt;- 0.25\n\n# Create the susceptibility matrix\nsusceptibility &lt;- \n  tribble(\n    ~age_group, ~unimmunised,\n       \"[0,5)\",          0.2,\n      \"[5,18)\",          0.5,\n     \"[18,40)\",          0.6,\n     \"[40,65)\",          0.9,\n         \"65+\",            1\n  ) %&gt;%\n  mutate(immunised = unimmunised * (1 - immunization_effect)) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\nsusceptibility\n\n        unimmunised immunised\n[0,5)           0.2     0.150\n[5,18)          0.5     0.375\n[18,40)         0.6     0.450\n[40,65)         0.9     0.675\n65+             1.0     0.750\n\n# Create the demography-in-susceptibility matrix\np_susceptibility &lt;- \n  tribble(\n    ~age_group, ~unimmunised,\n       \"[0,5)\",          0.6,\n      \"[5,18)\",          0.6,\n     \"[18,40)\",          0.6,\n     \"[40,65)\",          0.6,\n         \"65+\",          0.6\n  ) %&gt;%\n  mutate(immunised = 1 - unimmunised) %&gt;%\n  column_to_rownames(var = \"age_group\") %&gt;%\n  as.matrix()\n\np_susceptibility\n\n        unimmunised immunised\n[0,5)           0.6       0.4\n[5,18)          0.6       0.4\n[18,40)         0.6       0.4\n[40,65)         0.6       0.4\n65+             0.6       0.4\nPlease note that the code assumes the necessary packages are already installed. If they are not, you can install them using first the install.packages(\"pak\") function and then the pak::pak() function for both packages in CRAN or GitHub before loading them with library()."
  },
  {
    "objectID": "simulate_cases/finalsize_susceptibility_matrices.html#related",
    "href": "simulate_cases/finalsize_susceptibility_matrices.html#related",
    "title": "How to create heterogeneous susceptibility matrices?",
    "section": "Related",
    "text": "Related\n\nExplanation of susceptibility matrices for the finalsize package"
  }
]